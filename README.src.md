# CUBIC SPLINE

OTAKE Takayoshi, 2019-02-11

## Condition

2次元の $n+1$ 個の点の列:

$$
P = (p_i)_{i=0}^n \tag{1.1}
$$

のスプライン曲線を求める。

ここで、各点 $p_i$ を $(x_i, y_i)$ として $x_{i} < x_{i+1}$ と $n > 0$ を条件とする。

点が $n+1$ 個あるため、スプライン曲線は $n$ 個の区間曲線の列:

$$
Spline = (S_i)_{i=0}^{n-1} \tag{1.2}
$$

となるが、この区間曲線を3次数関数:

$$
S_i(x) = a_i (x - x_i)^3 + b_i (x - x_i)^2 + c_i (x - x_i) + d_i \tag{1.3}
$$

とする。


## Solution

簡単のため

$$
x_{d:i} = x_{i+1} - x_i, y_{d:i} = y_{i+1} - y_i
$$

とする。


区間曲線は区間の端の点を通るため

$$
S_i(x_i) = d_i = y_i \tag{2.1}
$$

である。また、隣接する区間曲線は同一の点を通るため

$$
S_i(x_{i+1}) = S_{i+1}(x_{i+1})
$$

$$
a_i x_{d:i}^3 + b_i x_{d:i}^2 + c_i x_{d:i} + y_i = y_{i+1}
$$

$$
a_i x_{d:i}^3 + b_i x_{d:i}^2 + c_i x_{d:i} = y_{d:i} \tag{2.2}
$$

である。

隣接する区間曲線は滑らかに連続するため、区間曲線の傾き:

$$
S_i'(x) = 3 a_i (x - x_i)^2 + 2 b_i (x - x_i) + c_i
$$

は区間曲線の隣接点で等しいため

$$
S_i'(x_{i+1}) = S_{i+1}'(x_{i+1})
$$

$$
3 a_i x_{d:i}^2 + 2 b_i x_{d:i} + c_i = c_{i+1} \tag{2.3}
$$

である。

eq. $(2.2)$ より

$$
c_i = \frac{y_{d:i}}{x_{d:i}} - a_i x_{d:i}^2 - b_i x_{d:i} \tag{2.2'}
$$

を eq. $(2.3)$ に代入して

$$
2 a_i x_{d:i}^2 + b_i x_{d:i} + \frac{y_{d:i}}{x_{d:i}} \\
= \frac{y_{d:i+1}}{x_{d:i+1}} - a_{i+1} x_{d:i+1}^2 - b_{i+1} x_{d:i+1} \tag{2.4}
$$

となる。ここで区間曲線は滑らかに連続するため、区間曲線の曲率:

$$
S_i''(x) = 6 a_i (x - x_i) + 2 b_i
$$

は区間曲線の隣接点で等しいため

$$
S_i''(x_{i+1}) = S_{i+1}''(x_{i+1})
$$

$$
6 a_i x_{d:i} + 2 b_i = 2 b_{i+1} \tag{2.5}
$$

である。

eq. $(2.5)$ より

$$
a_i = \frac{b_{i+1} - b_i}{3 x_{d:i}} \tag{2.5'}
$$

を eq. $(2.4)$ に代入して

$$
\frac{2}{3} (b_{i+1} - b_i) x_{d:i} + b_i x_{d:i} + \frac{y_{d:i}}{x_{d:i}} \\
= \frac{y_{d:i+1}}{x_{d:i+1}} - \frac{1}{3} (b_{i+2} - b_{i+1}) x_{d:i+1} - b_{i+1} x_{d:i+1}
$$

$$
x_{d:i} b_i + 2 (x_{d:i} + x_{d:i+1}) b_{i+1} + x_{d:i+1} b_{i+2} \\
= 3\left( \frac{y_{d:i+1}}{x_{d:i+1}} - \frac{y_{d:i}}{x_{d:i}} \right) = z_{i+1} \tag{2.6}
$$

ここで $b_0 = b_n = 0$ として、$n-1$ 個の方程式を行列で表すと

$$
\bold X = \left(
  \begin{array}{c}
    2(x_{d:0} + x_{d:1}) & x_{d:1} & & \bold0\\
    x_{d:1} & 2(x_{d:1} + x_{d:2}) & x_{d:2} \\
    \\
    & & \ddots \\
    \bold0 & & x_{d:n-2} & 2(x_{d:n-2} + x_{d:n-1})
  \end{array}
\right)
$$

$$
\bold X \cdot (b_1, b_2, \cdots, b_{n-1})^T = (z_1, z_2, \cdots, z_{n-1})^T
$$

となり、$\bold X$ は $(n-1) \times (n-1)$ の正方行列であるため

$$
(b_1, b_2, \cdots, b_{n-1})^T = \bold X^{-1} \cdot (z_1, z_2, \cdots, z_{n-1})^T \tag{2.7}
$$

となる。

eq. $(2.7)$ から $b_i$ が求まると、 eq. $(2.5')$ から $a_i$ が、eq. $(2.2')$ から $c_i$ が求まる。eq. $(2.1)$ より $d_i$ が求まっているためスプライン曲線が得られる。
